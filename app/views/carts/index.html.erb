

<div class="container">
  <div class ="row">
    <div class="col-12">
    <%= flash[:notice] %>
    <h2  class="margin_top">ショッピングカート</h2>
      <table class="table">
      <thead>
        <tr>
          <th style="border:none">商品画像</th>
          <th style="border:none">商品名</th>
          <th style="border:none">アーティスト名</th>
          <th style="border:none">価格(税込)</th>
          <th style="border:none">購入数量</th>
          <th style="border:none">小計</th>
          <th style="border:none"></th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <% num = 0 %>
          <% @carts.each do |cart| %>
          <td><%= attachment_image_tag cart.cd.cd_image_id, :cd_image_id, :fill, 20, 20 %></td>
          <td><%= cart.cd.single_album_name %></td>
          <td><%= cart.cd.artist.artist_name %></td>
          <td><%= cart.cd.price %>円</td>
          <td><%= form_with model: cart, url: cart_path(cart) do |f| %>
              <%= f.number_field :amount, :size=>"5" %>個
              <%= f.submit "変更" %></td>
          <% end %>

          <td><%= cart.cd.price * cart.amount %>円</td>
          <td><%= link_to "削除", cart_path(cart), class: "btn btn-danger btn-sm margin_top", method: :delete %></td>
        </tr>
      </tbody>
      <tbody>
        <tr>
          <td></td>
          <td></td>
          <td></td>
          <td></td>
          <% num += cart.cd.price * cart.amount %>
          <td></td>
          <td>
            <ul style="list-style:none">
              <li>送料：<%= @postage %>円</li>
              <li> 合計(税込)：<%= num + @postage %>円</li>
            </ul>
          </td>
        </tr>
      </tbody>
    </table>
      <%= link_to "お支払いへ進む", new_receipt_path, class: "btn btn-primary" %>
    </div>
     <% end %>
 </div>
</div>
